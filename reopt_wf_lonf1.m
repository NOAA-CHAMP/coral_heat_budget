1;

diary(fullfile(get_thesis_path('../src'),'reopt_wf_lonf1.log'));
more off
timenow

disp('**********************************************************************');
disp('CONTROL');
disp('**********************************************************************');
stn = optimize_station_heat_budget('lonf1','erai','avhrr_weekly','ndbc','tpxo_tide','erai',{'Q0_LOWPASS','_48_h_lp'});
stn=[]; clear stn;

%{
    {'_24_h_lp','SU',               0.66,{[0.675,1.250, 10],[0.675,1.250, 45],[0.675,1.250, 80],[0.675,1.250,110],[0.500,1.250, 10],[0.500,1.250, 45],[0.500,1.250, 80],[0.500,1.250,110],},{[0,1.00, 91]},},... %err 94.7,4.3
    {'_24_h_lp','UNSTEADY_SEASONAL',0.66,{[0.675,1.250, 10],[0.675,1.250, 45],[0.675,1.250, 80],[0.675,1.250,110],[0.500,1.250, 10],[0.500,1.250, 45],[0.500,1.250, 80],[0.500,1.250,110],},{[0,1.00, 91]},},... %err 94.7,4.3

%%%% IMPROVING
    {'_24_h_lp','SU',               0.66,{[0.675,1.250, 10],[0.675,1.250, 45],[0.675,1.250, 80],[0.675,1.250,110],[0.500,1.250, 10],[0.500,1.250, 45],[0.500,1.250, 80],[0.500,1.250,110],},{[0,1.00, 91]},},... %.5,1.25, 45: err 31.3,1.3
    {'_24_h_lp','UNSTEADY_SEASONAL',0.66,{[0.675,1.250, 10],[0.675,1.250, 45],[0.675,1.250, 80],[0.675,1.250,110],[0.500,1.250, 10],[0.500,1.250, 45],[0.500,1.250, 80],[0.500,1.250,110],},{[0,1.00, 91]},},... %.5,1.25, 10: err 29.4,2.6
%}

for cop={ ...
    {'_24_h_lp','SU',               0.66,{[0.500,1.250, 45],},{[0,1.00, 45]},},... %err 31.0,1.1
        };

    op = cop{:};
    lp = op{1};
    sc = op{2};
    wf = op{3};
    kd = op(4);
    ad = op(5);
    disp('**********************************************************************');
    disp(lp);
    disp({sc,wf,kd});
    disp(kd{:});
    disp(ad{:});
    disp('**********************************************************************');

    stn = optimize_station_heat_budget('lonf1','erai','avhrr_weekly','ndbc','tpxo_tide','erai',{'Q0_LOWPASS',lp},struct('hc_scaling',sc,'hc_warming_factor',wf,'override_light_kds',kd,'override_advection_factors',ad));
    stn=[]; clear stn;
    pause(1);

end;

timenow
more on
diary off
