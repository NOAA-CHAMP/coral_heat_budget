1;

diary(fullfile(get_thesis_path('../src'),'reopt_wf_looe1_5m.log'));
more off
timenow

%{
disp('**********************************************************************');
disp('CONTROL');
disp('**********************************************************************');
stn = optimize_station_heat_budget('looe1','erai','avhrr_weekly','ndbc','tpxo_tide','erai',{'sfld','mc_seatemp'});
stn=[]; clear stn;

    {'_24_h_lp','UNSTEADY_SEASONAL',0.66,{[0.050,0.400,137],},{[0,1.00, 45]},{[0,20, 45]},},... %err  2.4,1.9; OK OCT-DEC
    {'_24_h_lp','SU',               0.66,{[0.050,0.400,137],},{[0,0.50, 45]},{0},},... %err  6.1,2.1; NOT BAD JAN-JUN
    {'_24_h_lp','SU',               0.66,{[0.050,0.400,137],},{[0,0.50, 45]},{[0,20, 45]},},... %??
    {'_24_h_lp','SU',               0.66,{[0.050,0.400,137],},{0},{0},},... %err  ?.1,2.1
    {'_24_h_lp','SU',               0.66,{[0.050,0.400, 91],},{0},{0},},... %err  ?.2,0.9
    {'_24_h_lp','SU',               0.66,{[0.050,0.500, 91],},{0},{0},},... %err  ?.2,0.9
    {'_24_h_lp','SU',               0.66,{[0.050,0.600, 91],},{0},{0},},... %err  ?.2,0.9

    % REMOVE "bad dates"
    {'_24_h_lp','SU',               0.66,{[0.050,0.100, 45],},{0},{0},},... %err  2.4,2.2
    {'_24_h_lp','SU',               0.66,{[0.050,0.150, 45],},{0},{0},},... %err  2.5,1.6
    {'_24_h_lp','SU',               0.66,{[0.050,0.200, 45],},{0},{0},},... %err  3.3,1.4
    {'_24_h_lp','SU',               0.66,{[0.050,0.250, 45],},{0},{0},},... %err  3.9,1.4
    {'_24_h_lp','SU',               0.66,{[0.050,0.300, 45],},{0},{0},},... %err  4.3,1.4
    % KEEP "bad dates"
    {'_24_h_lp','SU',               0.66,{[0.050,0.100, 45],},{0},{0},},... %err  2.8,3.1
    {'_24_h_lp','SU',               0.66,{[0.050,0.150, 45],},{0},{0},},... %err  2.4,2.3
    {'_24_h_lp','SU',               0.66,{[0.050,0.200, 45],},{0},{0},},... %err  3.2,2.1
    {'_24_h_lp','SU',               0.66,{[0.050,0.250, 45],},{0},{0},},... %err  3.9,1.9
    {'_24_h_lp','SU',               0.66,{[0.050,0.300, 45],},{0},{0},},... %err  4.3,1.9

%%%% IMPROVING
    {'_24_h_lp','SU',               0.66,{[0.050,0.150, 45],},{0},{0},false},... %err  2.5,1.6
    {'_24_h_lp','SU',               0.66,{[0.050,0.200, 45],},{0},{0},true },... %err  3.2,2.1
    {'_24_h_lp','UNSTEADY_SEASONAL',0.66,{[0.050,0.150, 45],},{0},{0},false},... %err  1.9,1.8
    {'_24_h_lp','UNSTEADY_SEASONAL',0.66,{[0.050,0.200, 45],},{0},{0},true },... %err  2.4,2.1

    {'_24_h_lp','UNSTEADY_SEASONAL',0.66,{[0.075,0.150, 45],},{0},{0},false},... %err  2.9,1.6
    {'_24_h_lp','UNSTEADY_SEASONAL',0.66,{[0.075,0.200, 45],},{0},{0},true },... %err  3.6,1.9
    {'_24_h_lp','STEADY_SEASONAL',  0.66,{[0.050,0.150, 45],},{0},{0},false},... %err  2.1,2.0
    {'_24_h_lp','STEADY_SEASONAL',  0.66,{[0.075,0.150, 45],},{0},{0},false},... %err  2.9,1.7
    {'_24_h_lp','STEADY_SEASONAL',  0.66,{[0.075,0.200, 45],},{0},{0},true },... %err  3.5,2.2

%%%% EXPERIMENTS
    {'_24_h_lp','SS',               0.66,{[0.075,0.200, 45],},{0},{0},true },... %err  4.9,1.8
    {'_24_h_lp','SU',               0.66,{[0.075,0.200, 45],},{0},{0},true },... %err  5.7,1.9
    {'_24_h_lp','US',               0.66,{[0.075,0.200, 45],},{0},{0},true },... %err  4.1,1.8
    {'_24_h_lp','UU',               0.66,{[0.075,0.200, 45],},{0},{0},true },... %err  5.3,1.7
    {'_24_h_lp','ADAPTIVE',         0.66,{[0.075,0.200, 45],},{0},{0},true },... %err  9.4,1.9
    {'_24_h_lp','STEADY_SEASONAL',  0.66,{[0.075,0.200, 45],},{0},{0},true },... %err  3.5,2.2
    {'_24_h_lp','UNSTEADY_SEASONAL',0.66,{[0.075,0.200, 45],},{0},{0},true },... %err  3.6,1.9
%}

%%%% CONTROL: err 4.0, 1.5
for cop={ ...
    %{'_24_h_lp','UNSTEADY_SEASONAL',0.66,{[0.050,0.150, 45],},{0},{0},false},... %err  1.9,1.8
    {'_24_h_lp','UNSTEADY_SEASONAL',0.66,{[0.050,0.150, 45],},{[0.00,0.25, 45]},{[0,20, 45]},false},... %err  2.0,1.4
        };

    op = cop{:};
    lp = op{1};
    sc = op{2};
    wf = op{3};
    kd = op(4);
    ad = op(5);
    kt = op(6);
    kb = op{7};
    disp('**********************************************************************');
    disp(lp);
    disp({sc,wf,kd});
    disp(kd{:});
    disp(ad{:});
    disp(kt{:});
    disp(kb);
    disp('**********************************************************************');

    stn = optimize_station_heat_budget('looe1','erai','avhrr_weekly','ndbc','tpxo_tide','erai',{'sfld','mc_seatemp','Q0_LOWPASS',lp},struct('hc_scaling',sc,'hc_warming_factor',wf,'override_light_kds',kd,'override_advection_factors',ad,'override_k_thetas',kt,'keep_bad_dates',kb));
    stn=[]; clear stn;
    pause(1);

end;

timenow
more on
diary off
